<html>

<head>
  <title>Lottie/TGS Editor</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <link rel="stylesheet" type="text/css" href="css/animation-area.css">
  <link rel="stylesheet" type="text/css" href="css/timeline-area.css">
  <link rel="stylesheet" type="text/css" href="css/overlays.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.5.3/lottie.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.5/ace.js"></script>
  <script src="https://cdn.jsdelivr.net/pako/1.0.3/pako.min.js"></script>
  <script src="js/tab.js"></script>
  <script src="js/overlay.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/timeline-layer-child.js"></script>
  <script src="js/timeline-value.js"></script>
  <script src="js/timeline-property.js"></script>
  <script src="js/timeline-layer-transform.js"></script>
  <script src="js/timeline-layer-bar.js"></script>
  <script src="js/timeline-layer.js"></script>
  <script src="js/timeline-layer-types.js"></script>
  <script src="js/timeline.js"></script>
  <script src="js/main.js"></script>
</head>

<body style="color: #0000 !important;">
  <header>
    Lottie/TGS Editor
    <div id="headerButtons">
      <span id="infoButton" title="Info" class="material-icons white-button">info</span>
    </div>
  </header>
  <div id="tabHeader" class="subHeader">
    <span id="codeAreaButton" class="tabSwitcher active" onclick="switchToTab('codeArea')">
      JSON Data<span class="material-icons load">code</span>
    </span>
    <span id="timelineAreaButton" class="tabSwitcher" onclick="switchToTab('timelineArea')">
      Timeline Editor<span class="material-icons load">playlist_play</span>
    </span>
  </div>
  <div id="animationHeader" class="subHeader">Animation <span class="material-icons load">movie</span></div>
  <main>
    <div id="codeArea" class="tab active"></div>
    <div id="timelineArea" class="tab">
      <div style="position: absolute;text-align: center;bottom: 1em;width: 100%;z-index: 1;">The timeline editor is
        still a work in progress...</div> <!-- TODO: Remove this -->
      <table id="timelineAreaTable">
        <colgroup>
          <col style="width: 35%">
          <col style="width: 65%" id="timelineColumn">
        </colgroup>
        <tr id="timeline">
          <th id="currentFrame">Current frame: <span id="currentFrameValue" contenteditable="true">0</span></th>
          <td id="timelineHeader">
            <div id="frameMarker"></div>
            <div id="frameBlocks"></div>
          </td>
        </tr>
      </table>
    </div>
  </main>
  <div id="animationArea">
    <div id="animationView"></div>
    <p id="userIO">
      <span id="firstFrameButton" class="material-icons black-button" onclick="firstFrame()"
        title="First frame (down arrow)">first_page</span>
      <span id="prevFrameButton" class="material-icons black-button" onclick="prevFrame()"
        title="Previous frame (left arrow)">chevron_left</span>
      <span id="playPauseButton" class="material-icons black-button" onclick="playPause()"
        title="Play/pause (spacebar)">pause</span>
      <span id="nextFrameButton" class="material-icons black-button" onclick="nextFrame()"
        title="Next frame (right arrow)">chevron_right</span>
      <span id="lastFrameButton" class="material-icons black-button" onclick="lastFrame()"
        title="Last frame (up arrow)">last_page</span>
      <br><br>
      <button type="button" onclick="setAnimation()">Refresh</button>
      <input type="checkbox" id="autoRefresh" name="autoRefresh" value="autoRefresh" checked>
      <label for="autoRefresh">Auto refresh</label>
      <span id="IOdivider">||</span>
      <button type="button" onclick="formatCode()">Format Code</button>
      <br><br>
      Load file: <input type="file" id="fileInput"></input>
      <br><br>
      <button id="saveAsGzip">Save as TGS/Gzip</button>
      <button id="saveAsJSON">Save as Lottie/JSON</button>
    </p>
  </div>
  <div id="messageArea"></div>
  <div id="overlayBackground"></div>
  <div id="infoArea" class="overlay">
    <div id="closeInfoAreaButton" class="material-icons black-button">close</div>
    <h2>Michiel's Lottie/TGS Editor</h2>
    <p>This Lottie/TGS Editor was made as a tool to experiment with Lottie/TGS files, but it is slowly turning into a
      fully usable editor.</p>
    <p>
      TGS files are used for animated stickers in Telegram Messenger.
      TGS files are Gzip archives which contain Lottie data.
      The Lottie data is stored in JSON format, as can be seen in the code editor on this page.
    </p>
    <p>
      A useful resource for figuring out how the Lottie format works can be found
      <a target="_blank" href="https://mattia.basaglia.gitlab.io/python-lottie/group__Lottie.html">here</a>.
    </p>
    <p>Note that there are some extra requirements for adding you sticker to Telegram, see <a target="_blank"
        href="https://core.telegram.org/animated_stickers">here</a>.</p>
  </div>
  <div id="dropArea" class="overlay">
    <p>Drop a TGS or JSON file here to open it!</p>
    <p class="material-icons">open_in_browser</p>
    <p>Warning: this will erase the current animation!</p>
    <p class="small">(but you can still undo with CTRL+Z)</p>
  </div>
</body>

</html>